# download update docker binary
- hosts:
  - kube_cluster
  become: true
  gather_facts: true
  any_errors_fatal: "{{ any_errors_fatal | default(true) }}"
  roles:
  # 需要和全局变量里的 binary.yml 值保持一致
  - { role: cluster-ops/upgrade/normal, upgrade: "containerd" }
  - { role: cluster-ops/upgrade/normal, upgrade: "runc" }
  - { role: cluster-ops/upgrade/normal, upgrade: "crictl" }
  - { role: cluster-ops/upgrade/normal, upgrade: "critest" }
  - { role: cluster-ops/upgrade/normal, upgrade: "docker" }
  - { role: cluster-ops/upgrade/normal, upgrade: "docker_compose" }

# update docker
- hosts:
  - kube_cluster
  become: true
  serial: 2
  gather_facts: true
  any_errors_fatal: "{{ any_errors_fatal | default(true) }}"
  roles:
  - { role: container-runtime }
